import matplotlib.pyplot as plt
import numpy as np

# f= open("lstm.txt","r")
# content = f.readlines()
T_options = list(range(5, 30, 1))
all_accuracies = [[1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 0.09375, 1.0, 1.0], [1.0, 0.09375, 1.0, 1.0], [0.1953125, 1.0, 1.0, 0.1171875], [1.0, 0.1015625, 1.0, 1.0], [0.109375, 0.1171875, 0.109375, 1.0], [0.1015625, 0.1171875, 0.203125, 0.109375], [0.15625, 0.0625, 1.0, 1.0], [0.109375, 0.1171875, 0.1328125, 0.109375], [0.2265625, 0.2265625, 0.1640625, 0.8125], [0.0859375, 0.203125, 0.203125, 0.15625], [0.1953125, 1.0, 0.0859375, 0.8046875], [0.2109375, 1.0, 0.1640625, 1.0], [1.0, 0.2109375, 0.2109375, 0.1953125], [1.0, 0.6171875, 0.265625, 0.1875]]



all_losses = [[0.2699848711490631, 0.33066609501838684, 0.2453332245349884, 0.3222784698009491], [0.09543705731630325, 0.307237833738327, 0.1158849373459816, 0.29997220635414124], [0.09912014752626419, 0.10960124433040619, 0.20653031766414642, 0.27161380648612976], [0.1540917158126831, 0.1270306408405304, 0.1405845284461975, 0.14018571376800537], [0.10367530584335327, 0.12776309251785278, 0.2391451597213745, 0.20792649686336517], [0.22178761661052704, 0.07102657109498978, 0.06840940564870834, 0.074803426861763], [0.08410317450761795, 0.15009289979934692, 0.25984397530555725, 0.13911905884742737], [0.15452919900417328, 0.0934256836771965, 0.12085039913654327, 0.08734623342752457], [0.10484080761671066, 0.07679162919521332, 0.11318868398666382, 0.14473667740821838], [0.10943603515625, 0.13767553865909576, 0.11770808696746826, 0.1153125911951065], [0.041794728487730026, 0.07580965757369995, 0.08539067208766937, 0.14382290840148926], [0.03499038517475128, 2.3220643997192383, 0.028041478246450424, 0.07610959559679031], [0.1231728345155716, 2.322006940841675, 0.046887367963790894, 0.04398738220334053], [1.624312400817871, 0.12063795328140259, 0.09126009047031403, 2.316833257675171], [0.05603970214724541, 2.3160204887390137, 0.11552023142576218, 0.04370949789881706], [2.306992530822754, 2.3056459426879883, 2.306058168411255, 0.11960217356681824], [2.3048765659332275, 2.306766986846924, 2.0034422874450684, 2.306790351867676], [1.9153813123703003, 2.3073842525482178, 0.10647857934236526, 0.12979741394519806], [2.1406326293945312, 2.306044816970825, 2.043517589569092, 2.306360960006714], [2.002434730529785, 2.0042037963867188, 1.924187421798706, 0.400186151266098], [2.302016258239746, 2.1276333332061768, 1.8893715143203735, 1.9123997688293457], [1.602602243423462, 0.13609081506729126, 2.3106954097747803, 0.3960844576358795], [1.8104650974273682, 0.13833706080913544, 2.0763933658599854, 0.14422468841075897], [0.10505054146051407, 1.859924077987671, 1.9424275159835815, 1.804294466972351], [0.16376134753227234, 1.5724718570709229, 1.7864856719970703, 1.952073097229004]]

# print(all_losses)
# all_train_steps = [[910, 880, 930], [960, 1020, 1060], [1100, 1050, 1070], [1550, 1230, 1140], [1480, 1340, 1340], [1660, 2590, 1450], [501, 501, 501], [501, 501, 501], [501, 501, 501], [501, 501, 501], [501, 501, 501], [501, 501, 501], [501, 501, 501], [501, 501, 501], [501, 501, 501], [501, 501, 501]]
# # print(all_train_steps)

plt.figure(figsize=(19, 6))

mean_acc = list(np.array(all_accuracies).mean(axis=1))
maxstd_acc = list(np.array(all_accuracies).mean(axis=1) + np.array(all_accuracies).std(axis=1))
minstd_acc = list(np.array(all_accuracies).mean(axis=1) - np.array(all_accuracies).std(axis=1))

mean_loss = list(np.array(all_losses).mean(axis=1))
maxstd_loss = list(np.array(all_losses).mean(axis=1) + np.array(all_losses).std(axis=1))
minstd_loss = list(np.array(all_losses).mean(axis=1) - np.array(all_losses).std(axis=1))

# mean_train_steps = list(np.array(all_train_steps).mean(axis=1))

plt.subplot(1, 2, 1)
plt.plot(T_options, all_accuracies, "o", color="orange")
plt.plot(T_options, mean_acc, label="accuracy mean", color="orange")
plt.fill_between(T_options, maxstd_acc, minstd_acc, alpha = 0.2, label="accuracy std", color="orange")
plt.xlabel("input_length")
plt.ylabel("accuracy")
plt.legend()

plt.subplot(1, 2, 2)
plt.plot(T_options, all_losses, "o", color="orange")
plt.plot(T_options, mean_loss, label="loss mean", color="orange")
plt.fill_between(T_options, maxstd_loss, minstd_loss, alpha = 0.2, label="loss std", color="orange")
plt.xlabel("input_length")
plt.ylabel("loss")
plt.legend()

# plt.subplot(1, 3, 3)
# plt.plot(T_options, mean_train_steps, label="average train steps", color="orange")
# plt.xlabel("input_length")
# plt.ylabel("train steps")
# plt.legend()

plt.savefig("ltsm2.png")

plt.show()