import matplotlib.pyplot as plt
import numpy as np

# f= open("lstm.txt","r")
# content = f.readlines()
T_options = list(range(5, 36))

# rnn
all_accuracies = [[1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 0.09375, 1.0, 1.0], [1.0, 0.09375, 1.0, 1.0], [0.1953125, 1.0, 1.0, 0.1171875], [1.0, 0.1015625, 1.0, 1.0], [0.109375, 0.1171875, 0.109375, 1.0], [0.1015625, 0.1171875, 0.203125, 0.109375], [0.15625, 0.0625, 1.0, 1.0], [0.109375, 0.1171875, 0.1328125, 0.109375], [0.2265625, 0.2265625, 0.1640625, 0.8125], [0.0859375, 0.203125, 0.203125, 0.15625], [0.1953125, 1.0, 0.0859375, 0.8046875], [0.2109375, 1.0, 0.1640625, 1.0], [1.0, 0.2109375, 0.2109375, 0.1953125], [1.0, 0.6171875, 0.265625, 0.1875], [0.12, 0.16, 0.30, 0.70], [0.77, 0.8, 0.11, 0.65], [0.05, 0.67, 1.0, 0.59], [0.12, 1, 0.05, 0.05], [0.23, 0.12, 0.41, 0.21], [0.04, 0.38, 0.1, 0.12]]

all_losses = [[0.2699848711490631, 0.33066609501838684, 0.2453332245349884, 0.3222784698009491], [0.09543705731630325, 0.307237833738327, 0.1158849373459816, 0.29997220635414124], [0.09912014752626419, 0.10960124433040619, 0.20653031766414642, 0.27161380648612976], [0.1540917158126831, 0.1270306408405304, 0.1405845284461975, 0.14018571376800537], [0.10367530584335327, 0.12776309251785278, 0.2391451597213745, 0.20792649686336517], [0.22178761661052704, 0.07102657109498978, 0.06840940564870834, 0.074803426861763], [0.08410317450761795, 0.15009289979934692, 0.25984397530555725, 0.13911905884742737], [0.15452919900417328, 0.0934256836771965, 0.12085039913654327, 0.08734623342752457], [0.10484080761671066, 0.07679162919521332, 0.11318868398666382, 0.14473667740821838], [0.10943603515625, 0.13767553865909576, 0.11770808696746826, 0.1153125911951065], [0.041794728487730026, 0.07580965757369995, 0.08539067208766937, 0.14382290840148926], [0.03499038517475128, 2.3220643997192383, 0.028041478246450424, 0.07610959559679031], [0.1231728345155716, 2.322006940841675, 0.046887367963790894, 0.04398738220334053], [1.624312400817871, 0.12063795328140259, 0.09126009047031403, 2.316833257675171], [0.05603970214724541, 2.3160204887390137, 0.11552023142576218, 0.04370949789881706], [2.306992530822754, 2.3056459426879883, 2.306058168411255, 0.11960217356681824], [2.3048765659332275, 2.306766986846924, 2.0034422874450684, 2.306790351867676], [1.9153813123703003, 2.3073842525482178, 0.10647857934236526, 0.12979741394519806], [2.1406326293945312, 2.306044816970825, 2.043517589569092, 2.306360960006714], [2.002434730529785, 2.0042037963867188, 1.924187421798706, 0.400186151266098], [2.302016258239746, 2.1276333332061768, 1.8893715143203735, 1.9123997688293457], [1.602602243423462, 0.13609081506729126, 2.3106954097747803, 0.3960844576358795], [1.8104650974273682, 0.13833706080913544, 2.0763933658599854, 0.14422468841075897], [0.10505054146051407, 1.859924077987671, 1.9424275159835815, 1.804294466972351], [0.16376134753227234, 1.5724718570709229, 1.7864856719970703, 1.952073097229004], [2.690, 1.970, 1.567, 0.684], [0.666, 0.429, 2.315, 0.685], [2.339, 0.548, 0.15, 0.844], [2.079, 0.137, 2.333, 2.338], [1.949, 2.299, 1.149, 2.006], [2.286, 1.598, 2.003, 2.023]]

#lstm xavier
# all_accuracies =[[1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 0.21875, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [0.0859375, 1.0, 0.296875, 1.0], [1.0, 1.0, 0.078125, 0.0859375], [1.0, 1.0, 1.0, 1.0], [1.0, 0.1015625, 0.15625, 0.15625]]
# all_losses =[[0.8638867139816284, 0.9974862933158875, 0.9696956276893616, 0.9717702269554138], [0.72097247838974, 0.6306525468826294, 0.6952158212661743, 0.6221612691879272], [0.46359920501708984, 0.4679608643054962, 0.45607078075408936, 0.5364968180656433], [0.26691845059394836, 0.41460466384887695, 0.3678930103778839, 0.24081215262413025], [0.11221954971551895, 0.10137352347373962, 0.11699063330888748, 0.2507256269454956], [0.38302281498908997, 0.16390885412693024, 0.16579750180244446, 0.2071767896413803], [0.1602783054113388, 0.22052057087421417, 0.26032963395118713, 0.1467706263065338], [0.13765273988246918, 0.1928127408027649, 0.247270405292511, 0.1534447818994522], [0.10794086754322052, 0.2526232898235321, 0.12740474939346313, 0.07931458204984665], [0.037026647478342056, 0.13780318200588226, 0.11698539555072784, 0.12190020084381104], [0.06722266972064972, 0.0418991819024086, 0.1643417775630951, 0.08866967260837555], [0.12112850695848465, 0.09576418995857239, 0.09700439870357513, 0.09155784547328949], [0.033249977976083755, 0.038392212241888046, 0.03751780092716217, 0.09258012473583221], [0.03880101442337036, 0.031777165830135345, 0.033051542937755585, 0.09581118822097778], [0.04902975261211395, 0.04770584776997566, 0.057393189519643784, 0.09217210114002228], [0.05869327858090401, 0.0550362691283226, 0.029117632657289505, 0.022480223327875137], [0.06499014794826508, 0.033874571323394775, 0.058760665357112885, 0.04794876277446747], [0.07523926347494125, 0.025125015527009964, 0.046082038432359695, 0.05662768706679344], [0.0658598393201828, 0.019275635480880737, 0.0416564904153347, 0.03984125331044197], [0.022822316735982895, 0.04141751676797867, 0.054034750908613205, 0.08219008147716522], [0.020541202276945114, 0.09966219961643219, 0.047544267028570175, 0.02064017951488495], [0.03724900633096695, 0.04487534239888191, 0.09452947229146957, 0.026727423071861267], [0.03434683755040169, 0.026183761656284332, 0.0494554303586483, 0.10388565063476562], [0.04205216094851494, 0.08209937065839767, 0.06528106331825256, 0.0977528840303421], [0.05324111878871918, 0.09606987237930298, 0.0715363547205925, 0.061848096549510956], [0.04983503744006157, 0.04818710684776306, 0.07980012893676758, 0.02632351964712143], [0.03224021568894386, 0.039655208587646484, 0.05015578493475914, 0.028231259435415268], [0.034741949290037155, 0.033464670181274414, 0.030747178941965103, 0.020751696079969406], [0.023483306169509888, 0.05166436359286308, 0.1512773633003235, 0.05139222368597984], [0.047967590391635895, 0.06376618146896362, 0.09727554023265839, 0.07079693675041199], [0.1815924048423767, 0.07036103308200836, 0.022394485771656036, 0.04929303377866745], [0.04363764822483063, 0.04125041514635086, 0.08722587674856186, 0.06424261629581451], [0.03953233361244202, 0.11236278712749481, 0.048720549792051315, 0.03443978726863861], [0.06284727156162262, 1.9205354452133179, 0.085739366710186, 0.01739165186882019], [0.028867579996585846, 0.027865473181009293, 0.05803149566054344, 0.08532099425792694], [2.305786609649658, 0.1345236599445343, 1.662961483001709, 0.02870822697877884], [0.0646965503692627, 0.16481080651283264, 2.2022249698638916, 2.3060319423675537], [0.11680996417999268, 0.04119027033448219, 0.12233871221542358, 0.09307070076465607], [0.06105528771877289, 2.2742631435394287, 2.3022851943969727, 2.302445411682129]]

# lstm kaiming
# all_accuracies = [[1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0],[1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0], [0.1328125, 1.0, 1.0, 1.0]]
# all_losses = [[1.1308568716049194, 0.9672382473945618, 1.104954481124878, 1.1526296138763428], [0.5790334939956665, 0.5302049517631531, 0.7252439856529236, 0.5367144346237183], [0.5528947114944458, 0.6003289222717285, 0.6978054642677307, 0.634829044342041], [0.260630339384079, 0.22842779755592346, 0.24101224541664124, 0.3145606815814972], [0.1691645383834839, 0.1729005128145218, 0.19980373978614807, 0.18769396841526031], [0.12956011295318604, 0.12672702968120575, 0.1465119868516922, 0.15559162199497223], [0.1587049961090088, 0.17899101972579956, 0.08325595408678055, 0.1556795835494995], [0.11216611415147781, 0.11488260328769684, 0.15165522694587708, 0.07753163576126099], [0.09853103011846542, 0.10001872479915619, 0.1639648973941803, 0.060128793120384216], [0.08945579826831818, 0.060011234134435654, 0.05206058919429779, 0.03133916109800339], [0.040800541639328, 0.1474105566740036, 0.041778020560741425, 0.03901030123233795], [0.04501957446336746, 0.05812613666057587, 0.14520598948001862, 0.07577788084745407], [0.04495760798454285, 0.04591778293251991, 0.07675255089998245, 0.027710556983947754], [0.03143937140703201, 0.025559164583683014, 0.05349362641572952, 0.0548742450773716], [0.07501793652772903, 0.09073025733232498, 0.07900356501340866, 0.15317100286483765], [0.043872226029634476, 0.04395568370819092, 0.022830046713352203, 0.07102227210998535], [0.08239419758319855, 0.05187508463859558, 0.08217085152864456, 0.019810475409030914], [0.025680333375930786, 0.06909464299678802, 0.11513397097587585, 0.023628458380699158], [0.1253165602684021, 0.027581866830587387, 0.04934210330247879, 0.028328880667686462], [0.04575809836387634, 0.05264269560575485, 0.0513286367058754, 0.05995801091194153], [0.024985946714878082, 0.07625941932201385, 0.11300000548362732, 0.0163748599588871], [0.039995305240154266, 0.01639280468225479, 0.034101758152246475, 0.06756117939949036], [0.06520421802997589, 0.04208056628704071, 0.05232134088873863, 0.021781951189041138], [0.038905832916498184, 0.04775971174240112, 0.08044251799583435, 0.04572206735610962], [0.03941650688648224, 0.03970148414373398, 0.08843673765659332, 0.05033368244767189], [0.03625502437353134, 0.0783100426197052, 0.014457203447818756, 0.05124121531844139], [0.05196700990200043, 0.019960306584835052, 0.05486993491649628, 0.03687465935945511], [0.0962982103228569, 0.03885169327259064, 0.10734017193317413, 0.05039340630173683], [0.015227176249027252, 0.06966038048267365, 0.06726638972759247, 0.07579492032527924], [0.023983895778656006, 0.1288454830646515, 0.03657951205968857, 0.09424669295549393], [0.04885410517454147, 0.00796588510274887, 0.06499864161014557, 0.03484984114766121], [0.04109923914074898, 0.051963385194540024, 0.12170851230621338, 0.04191959649324417], [0.0706554502248764, 0.10202644765377045, 0.08565384894609451, 0.08816862106323242], [0.06393560767173767, 0.029254961758852005, 0.024513326585292816, 0.025869112461805344], [0.028254739940166473, 0.11500751972198486, 0.06158056482672691, 0.03220697492361069], [0.1380278617143631, 0.11302074790000916, 0.05337659642100334, 0.07739593833684921], [0.06320361793041229, 0.04709513857960701, 0.06397436559200287, 0.07091619074344635], [0.04724568873643875, 0.04104737192392349, 0.021397389471530914, 0.044929951429367065], [2.2997052669525146, 0.045224227011203766, 0.04033856838941574, 0.05928404629230499]]

print(len(all_accuracies))
print(len(all_losses))
print(len(T_options))

plt.figure(figsize=(15, 6))

mean_acc = list(np.array(all_accuracies).mean(axis=1))
maxstd_acc = list(np.array(all_accuracies).mean(axis=1) + np.array(all_accuracies).std(axis=1))
minstd_acc = list(np.array(all_accuracies).mean(axis=1) - np.array(all_accuracies).std(axis=1))

mean_loss = list(np.array(all_losses).mean(axis=1))
maxstd_loss = list(np.array(all_losses).mean(axis=1) + np.array(all_losses).std(axis=1))
minstd_loss = list(np.array(all_losses).mean(axis=1) - np.array(all_losses).std(axis=1))

# mean_train_steps = list(np.array(all_train_steps).mean(axis=1))

plt.subplot(1, 2, 1)
plt.plot(T_options, all_accuracies, "o", color="orange")
plt.plot(T_options, mean_acc, label="accuracy mean", color="orange")
plt.fill_between(T_options, maxstd_acc, minstd_acc, alpha = 0.2, label="accuracy std", color="orange")
plt.xlabel("input_length")
plt.ylabel("accuracy")
plt.title("Accuracy over training time")

plt.subplot(1, 2, 2)
plt.plot(T_options, all_losses, "o", color="orange")
plt.plot(T_options, mean_loss, label="loss mean", color="orange")
plt.fill_between(T_options, maxstd_loss, minstd_loss, alpha = 0.2, label="loss std", color="orange")
plt.xlabel("input_length")
plt.ylabel("loss")
plt.title("Loss over training time")

# plt.subplot(1, 3, 3)
# plt.plot(T_options, mean_train_steps, label="average train steps", color="orange")
# plt.xlabel("input_length")
# plt.ylabel("train steps")
# plt.legend()

# plt.savefig("rnn_1_39.png")

plt.show()